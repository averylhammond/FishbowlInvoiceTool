from decimal import Decimal


# Invoice class to hold all attributes of the invoice. This represents a single invoice generated by Fishbowl
# Note that Decimal types are used for all currency values to avoid floating point precision issues caused
# by the Fishbowl software
class Invoice:

    def __init__(self):
        """
        Initializes the Invoice object with default values for all attributes
        """

        # fmt:off
        self.customer_name   = ""               # Name of customer on invoice
        self.date            = ""               # Date of invoice
        self.order_number    = ""               # Order Number, e.g. S12345
        self.po_number       = ""               # PO Number
        self.payment_terms   = ""               # Listed payment terms
        self.sales_rep       = ""               # Sales rep identifier
        self.labor_cost      = Decimal("0.0")   # Total cost of labor
        self.material_cost   = Decimal("0.0")   # Total cost of material
        self.shipping_cost   = Decimal("0.0")   # Total cost of shipping
        self.subtotal        = Decimal("0.0")   # subtotal, from summing labor_cost, material_cost, and shipping_cost
        self.sales_tax       = Decimal("0.0")   # Additional sales tax
        self.total           = Decimal("0.0")   # Calculated as subtotal plus sales_tax
        self.listed_total    = Decimal("0.0")   # Total as listed on the invoice, to compare to the calculated total
        self.page_contents   = []               # List of strings, each string is the text from a page of the invoice PDF
        # fmt:on

    def to_formatted_string(self):
        """
        Returns a formatted string to output invoice contents

        Returns:
            str: A formatted string containing all of the invoice's fields on separate lines
        """

        return (
            "***********************************\n"
            "Processed Invoice Results:\n"
            f"Customer Name:    {self.customer_name}\n"
            f"Invoice Date:     {self.date}\n"
            f"Order Number:     {self.order_number}\n"
            f"PO Number:        {self.po_number}\n"
            f"Payment Terms:    {self.payment_terms}\n"
            f"Sales Rep:        {self.sales_rep}\n"
            f"Labor Cost:       ${self.labor_cost}\n"
            f"Material Cost:    ${self.material_cost}\n"
            f"Shipping Cost:    ${self.shipping_cost}\n"
            f"subtotal:         ${self.subtotal}\n"
            f"Sales Tax:        ${self.sales_tax}\n"
            f"Calculated Total: ${self.total}\n"
            f"Listed Total:     ${self.listed_total}\n"
            "***********************************\n"
        )
